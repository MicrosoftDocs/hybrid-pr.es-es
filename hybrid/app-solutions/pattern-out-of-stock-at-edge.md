---
title: Detección de existencias agotadas con Azure y Azure Stack Edge
description: Aprenda a usar los servicios de Azure y Azure Stack Edge para implementar la detección de existencias agotadas.
author: BryanLa
ms.topic: article
ms.date: 05/24/2021
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 05/24/2021
ms.openlocfilehash: b25a6391c4e64fa7018031bac4fb7d098c56b529
ms.sourcegitcommit: cf2c4033d1b169f5b63980ce1865281366905e2e
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 05/25/2021
ms.locfileid: "110343882"
---
# <a name="out-of-stock-detection-at-the-edge-pattern"></a><span data-ttu-id="35a75-103">Patrón de detección de existencias agotadas en el perímetro</span><span class="sxs-lookup"><span data-stu-id="35a75-103">Out of stock detection at the edge pattern</span></span>

<span data-ttu-id="35a75-104">Este patrón muestra cómo determinar si los estantes contienen artículos con existencias agotadas mediante un dispositivo de Azure Stack Edge o Azure IoT Edge y cámaras de red.</span><span class="sxs-lookup"><span data-stu-id="35a75-104">This pattern illustrates how to determine if shelves have out of stock items using an Azure Stack Edge or Azure IoT Edge device and network cameras.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="35a75-105">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="35a75-105">Context and problem</span></span>

<span data-ttu-id="35a75-106">Las tiendas físicas pierden ventas porque cuando los clientes buscan un artículo, no existe en el estante.</span><span class="sxs-lookup"><span data-stu-id="35a75-106">Physical retail stores lose sales because when customers look for an item, it's not present on the shelf.</span></span> <span data-ttu-id="35a75-107">Sin embargo, puede que el artículo esté en la trastienda pero que no se haya repuesto.</span><span class="sxs-lookup"><span data-stu-id="35a75-107">However, the item could have been in the back of the store and not been restocked.</span></span> <span data-ttu-id="35a75-108">A las tiendas les gustaría que sus empleados pudieran trabajar de una manera más eficaz y recibir notificaciones automáticas cuando sea necesario reponer artículos.</span><span class="sxs-lookup"><span data-stu-id="35a75-108">Stores would like to use their staff more efficiently and get automatically notified when items need restocking.</span></span>

## <a name="solution"></a><span data-ttu-id="35a75-109">Solución</span><span class="sxs-lookup"><span data-stu-id="35a75-109">Solution</span></span>

<span data-ttu-id="35a75-110">En el ejemplo de la solución se usa un dispositivo perimetral, como Azure Stack Edge en cada tienda, que procesa los datos de las cámaras de la tienda de manera eficaz.</span><span class="sxs-lookup"><span data-stu-id="35a75-110">The solution example uses an edge device, like an Azure Stack Edge in each store, which efficiently processes data from cameras in the store.</span></span> <span data-ttu-id="35a75-111">Este diseño optimizado permite a las tiendas enviar solo las imágenes y los eventos apropiados a la nube.</span><span class="sxs-lookup"><span data-stu-id="35a75-111">This optimized design lets stores send only relevant events and images to the cloud.</span></span> <span data-ttu-id="35a75-112">El diseño ahorra ancho de banda y espacio de almacenamiento y garantiza la privacidad de los clientes.</span><span class="sxs-lookup"><span data-stu-id="35a75-112">The design saves bandwidth, storage space, and ensures customer privacy.</span></span> <span data-ttu-id="35a75-113">A medida que se leen los fotogramas de cada cámara, un modelo de aprendizaje automático procesa la imagen y devuelve todas las áreas con existencias agotadas.</span><span class="sxs-lookup"><span data-stu-id="35a75-113">As frames are read from each camera, an ML model processes the image and returns any out of stock areas.</span></span> <span data-ttu-id="35a75-114">La imagen y las áreas con existencias agotadas se muestran en una aplicación web local.</span><span class="sxs-lookup"><span data-stu-id="35a75-114">The image and out of stock areas are displayed on a local web app.</span></span> <span data-ttu-id="35a75-115">Estos datos se pueden enviar a un entorno de Time Series Insight para mostrar información detallada en Power BI.</span><span class="sxs-lookup"><span data-stu-id="35a75-115">This data can be sent to a Time Series Insight environment to show insights in Power BI.</span></span>

![Arquitectura de la solución de existencias agotadas en el perímetro](media/pattern-out-of-stock-at-edge/solution-architecture.png)

<span data-ttu-id="35a75-117">Así es como funciona la solución:</span><span class="sxs-lookup"><span data-stu-id="35a75-117">Here's how the solution works:</span></span>

1. <span data-ttu-id="35a75-118">Las imágenes se capturan con una cámara de red a través de HTTP o RTSP.</span><span class="sxs-lookup"><span data-stu-id="35a75-118">Images are captured from a network camera over HTTP or RTSP.</span></span>
2. <span data-ttu-id="35a75-119">La imagen se redimensiona y se envía al controlador de inferencia, que se comunica con el modelo de aprendizaje automático para determinar si hay alguna imagen de existencias agotadas.</span><span class="sxs-lookup"><span data-stu-id="35a75-119">The image is resized and sent to the inference driver, which communicates with the ML model to determine if there are any out of stock images.</span></span>
3. <span data-ttu-id="35a75-120">El modelo de aprendizaje automático devuelve todas las áreas de existencias agotadas.</span><span class="sxs-lookup"><span data-stu-id="35a75-120">The ML model returns any out of stock areas.</span></span>
4. <span data-ttu-id="35a75-121">El controlador de inferencia carga la imagen sin procesar en un blob (si se especifica) y envía los resultados del modelo a Azure IoT Hub y a un procesador de rectángulo de selección en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="35a75-121">The inferencing driver uploads the raw image to a blob (if specified), and sends the results from the model to Azure IoT Hub and a bounding box processor on the device.</span></span>
5. <span data-ttu-id="35a75-122">El procesador de rectángulo de selección agrega rectángulos de selección y almacena en caché la ruta de acceso de la imagen en una base de datos en memoria.</span><span class="sxs-lookup"><span data-stu-id="35a75-122">The bounding box processor adds bounding boxes to the image and caches the image path in an in-memory database.</span></span>
6. <span data-ttu-id="35a75-123">La aplicación web consulta las imágenes y las muestra en el orden recibido.</span><span class="sxs-lookup"><span data-stu-id="35a75-123">The web app queries for images and shows them in the order received.</span></span>
7. <span data-ttu-id="35a75-124">Los mensajes de IoT Hub se agregan en Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="35a75-124">Messages from IoT Hub are aggregated in Time Series Insights.</span></span>
8. <span data-ttu-id="35a75-125">Power BI muestra un informe interactivo de elementos con existencias agotadas con el tiempo con los datos de Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="35a75-125">Power BI displays an interactive report of out of stock items over time with the data from Time Series Insights.</span></span>


## <a name="components"></a><span data-ttu-id="35a75-126">Componentes</span><span class="sxs-lookup"><span data-stu-id="35a75-126">Components</span></span>

<span data-ttu-id="35a75-127">Esta solución usa los siguientes componentes:</span><span class="sxs-lookup"><span data-stu-id="35a75-127">This solution uses the following components:</span></span>

| <span data-ttu-id="35a75-128">Nivel</span><span class="sxs-lookup"><span data-stu-id="35a75-128">Layer</span></span> | <span data-ttu-id="35a75-129">Componente</span><span class="sxs-lookup"><span data-stu-id="35a75-129">Component</span></span> | <span data-ttu-id="35a75-130">Descripción</span><span class="sxs-lookup"><span data-stu-id="35a75-130">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="35a75-131">Hardware local</span><span class="sxs-lookup"><span data-stu-id="35a75-131">On-premises hardware</span></span> | <span data-ttu-id="35a75-132">Cámara de red</span><span class="sxs-lookup"><span data-stu-id="35a75-132">Network camera</span></span> | <span data-ttu-id="35a75-133">Se requiere una cámara de red, con una fuente HTTP o RTSP para proporcionar inferencia a las imágenes.</span><span class="sxs-lookup"><span data-stu-id="35a75-133">A network camera is required, with either an HTTP or RTSP feed to provide the images for inference.</span></span> |
| <span data-ttu-id="35a75-134">Azure</span><span class="sxs-lookup"><span data-stu-id="35a75-134">Azure</span></span> | <span data-ttu-id="35a75-135">Azure IoT Hub</span><span class="sxs-lookup"><span data-stu-id="35a75-135">Azure IoT Hub</span></span> | <span data-ttu-id="35a75-136">[Azure IoT Hub](/azure/iot-hub/) administra el aprovisionamiento de dispositivos y la mensajería de los dispositivos perimetrales.</span><span class="sxs-lookup"><span data-stu-id="35a75-136">[Azure IoT Hub](/azure/iot-hub/) handles device provisioning and messaging for the edge devices.</span></span> |
|  | <span data-ttu-id="35a75-137">Azure Time Series Insights</span><span class="sxs-lookup"><span data-stu-id="35a75-137">Azure Time Series Insights</span></span> | <span data-ttu-id="35a75-138">[Azure Time Series Insights](/azure/time-series-insights/) almacena los mensajes de IoT Hub para su visualización.</span><span class="sxs-lookup"><span data-stu-id="35a75-138">[Azure Time Series Insights](/azure/time-series-insights/) stores the messages from IoT Hub for visualization.</span></span> |
|  | <span data-ttu-id="35a75-139">Power BI</span><span class="sxs-lookup"><span data-stu-id="35a75-139">Power BI</span></span> | <span data-ttu-id="35a75-140">[Microsoft Power BI](https://powerbi.microsoft.com/) proporciona informes centrados en el negocio de los eventos de existencias agotadas.</span><span class="sxs-lookup"><span data-stu-id="35a75-140">[Microsoft Power BI](https://powerbi.microsoft.com/) provides business-focused reports of out of stock events.</span></span> <span data-ttu-id="35a75-141">Power BI proporciona una interfaz de panel fácil de usar para ver los resultados de Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="35a75-141">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="35a75-142">Dispositivo de Azure Stack Edge o de</span><span class="sxs-lookup"><span data-stu-id="35a75-142">Azure Stack Edge or</span></span><br><span data-ttu-id="35a75-143">Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="35a75-143">Azure IoT Edge device</span></span> | <span data-ttu-id="35a75-144">Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="35a75-144">Azure IoT Edge</span></span> | <span data-ttu-id="35a75-145">[Azure IoT Edge](/azure/iot-edge/) orquesta el entorno de ejecución de los contenedores locales y controla la administración de dispositivos y las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="35a75-145">[Azure IoT Edge](/azure/iot-edge/) orchestrates the runtime for the on-premises containers and handles device management and updates.</span></span>|
| | <span data-ttu-id="35a75-146">Project Brainwave de Azure</span><span class="sxs-lookup"><span data-stu-id="35a75-146">Azure project brainwave</span></span> | <span data-ttu-id="35a75-147">En un dispositivo Azure Stack Edge, [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) emplea matrices de puertas programables en campo (FPGA) para acelerar la inferencia de aprendizaje automático.</span><span class="sxs-lookup"><span data-stu-id="35a75-147">On an Azure Stack Edge device, [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) uses Field-Programmable Gate Arrays (FPGAs) to accelerate ML inferencing.</span></span>|

## <a name="issues-and-considerations"></a><span data-ttu-id="35a75-148">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="35a75-148">Issues and considerations</span></span>

<span data-ttu-id="35a75-149">Tenga en cuenta los puntos siguientes al decidir cómo implementar esta solución:</span><span class="sxs-lookup"><span data-stu-id="35a75-149">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="35a75-150">Escalabilidad</span><span class="sxs-lookup"><span data-stu-id="35a75-150">Scalability</span></span>

<span data-ttu-id="35a75-151">La mayoría de los modelos de aprendizaje automático solo se pueden ejecutar con un determinado número de fotogramas por segundo, en función del hardware proporcionado.</span><span class="sxs-lookup"><span data-stu-id="35a75-151">Most machine learning models can only run at a certain number of frames per second, depending on the provided hardware.</span></span> <span data-ttu-id="35a75-152">Determine la frecuencia de muestreo óptima de las cámaras para asegurarse de que no se hace una copia de seguridad de la canalización de aprendizaje automático.</span><span class="sxs-lookup"><span data-stu-id="35a75-152">Determine the optimal sample rate from your camera(s) to ensure that the ML pipeline doesn't back up.</span></span> <span data-ttu-id="35a75-153">Distintos tipos de hardware administrarán diferentes números de cámaras y velocidades de fotogramas.</span><span class="sxs-lookup"><span data-stu-id="35a75-153">Different types of hardware will handle different numbers of cameras and frame rates.</span></span>

### <a name="availability"></a><span data-ttu-id="35a75-154">Disponibilidad</span><span class="sxs-lookup"><span data-stu-id="35a75-154">Availability</span></span>

<span data-ttu-id="35a75-155">Es importante tener en cuenta lo que podría suceder si el dispositivo perimetral perdiera la conectividad.</span><span class="sxs-lookup"><span data-stu-id="35a75-155">It's important to consider what might happen if the edge device loses connectivity.</span></span> <span data-ttu-id="35a75-156">Considere qué datos pueden perderse del panel de Time Series Insights y Power BI.</span><span class="sxs-lookup"><span data-stu-id="35a75-156">Consider what data might be lost from the Time Series Insights and Power BI dashboard.</span></span> <span data-ttu-id="35a75-157">La solución de ejemplo proporcionada no está diseñada para una alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="35a75-157">The example solution as provided isn't designed to be highly available.</span></span>

### <a name="manageability"></a><span data-ttu-id="35a75-158">Facilidad de uso</span><span class="sxs-lookup"><span data-stu-id="35a75-158">Manageability</span></span>

<span data-ttu-id="35a75-159">Esta solución puede abarcar muchos dispositivos y ubicaciones, lo que podría resultar complicado.</span><span class="sxs-lookup"><span data-stu-id="35a75-159">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="35a75-160">Los servicios de IoT de Azure pueden poner en línea automáticamente nuevas ubicaciones y dispositivos y mantenerlos actualizados.</span><span class="sxs-lookup"><span data-stu-id="35a75-160">Azure's IoT services can automatically bring new locations and devices online and keep them up to date.</span></span> <span data-ttu-id="35a75-161">También se deben seguir los procedimientos de gobierno de datos adecuados.</span><span class="sxs-lookup"><span data-stu-id="35a75-161">Proper data governance procedures must be followed as well.</span></span>

### <a name="security"></a><span data-ttu-id="35a75-162">Seguridad</span><span class="sxs-lookup"><span data-stu-id="35a75-162">Security</span></span>

<span data-ttu-id="35a75-163">Este patrón controla los datos potencialmente confidenciales.</span><span class="sxs-lookup"><span data-stu-id="35a75-163">This pattern handles potentially sensitive data.</span></span> <span data-ttu-id="35a75-164">Asegúrese de que las claves se rotan regularmente y de que los permisos de la cuenta de Azure Storage y los recursos compartidos locales están establecidos correctamente.</span><span class="sxs-lookup"><span data-stu-id="35a75-164">Make sure keys are regularly rotated and the permissions on the Azure Storage Account and local shares are correctly set.</span></span>

## <a name="next-steps"></a><span data-ttu-id="35a75-165">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="35a75-165">Next steps</span></span>

<span data-ttu-id="35a75-166">Para más información sobre los temas presentados en este artículo:</span><span class="sxs-lookup"><span data-stu-id="35a75-166">To learn more about topics introduced in this article:</span></span>
- <span data-ttu-id="35a75-167">En este patrón se usan varios servicios relacionados con IoT, como [Azure IoT Edge](/azure/iot-edge/), [Azure IoT Hub](/azure/iot-hub/) y [Azure Time Series Insights](/azure/time-series-insights/).</span><span class="sxs-lookup"><span data-stu-id="35a75-167">Multiple IoT related services are used in this pattern, including [Azure IoT Edge](/azure/iot-edge/), [Azure IoT Hub](/azure/iot-hub/), and [Azure Time Series Insights](/azure/time-series-insights/).</span></span>
- <span data-ttu-id="35a75-168">Para más información sobre Microsoft Project Brainwave, consulte el [anuncio del blog](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) y vea el [vídeo de Azure Machine Learning acelerado con Project Brainwave](https://www.youtube.com/watch?v=DJfMobMjCX0).</span><span class="sxs-lookup"><span data-stu-id="35a75-168">To learn more about Microsoft Project Brainwave, see [the blog announcement](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) and checkout out the [Azure Accelerated Machine Learning with Project Brainwave video](https://www.youtube.com/watch?v=DJfMobMjCX0).</span></span>
- <span data-ttu-id="35a75-169">Consulte [Consideraciones sobre el diseño de aplicaciones híbridas](overview-app-design-considerations.md) para más información sobre los procedimientos recomendados y para obtener respuestas a preguntas adicionales.</span><span class="sxs-lookup"><span data-stu-id="35a75-169">See [Hybrid app design considerations](overview-app-design-considerations.md) to learn more about best practices and to get answers to any additional questions.</span></span>
- <span data-ttu-id="35a75-170">Consulte la información relativa a la [familia de productos y soluciones de Azure Stack](/azure-stack) para más información sobre toda la gama de productos y soluciones.</span><span class="sxs-lookup"><span data-stu-id="35a75-170">See the [Azure Stack family of products and solutions](/azure-stack) to learn more about the entire portfolio of products and solutions.</span></span>

<span data-ttu-id="35a75-171">Cuando esté listo para probar la solución de ejemplo, continúe con la [guía para la implementación de soluciones de inferencia de ML de Edge](https://aka.ms/edgeinferencingdeploy).</span><span class="sxs-lookup"><span data-stu-id="35a75-171">When you're ready to test the solution example, continue with the [Edge ML inferencing solution deployment guide](https://aka.ms/edgeinferencingdeploy).</span></span> <span data-ttu-id="35a75-172">La guía de implementación proporciona instrucciones paso a paso para implementar y probar sus componentes.</span><span class="sxs-lookup"><span data-stu-id="35a75-172">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
